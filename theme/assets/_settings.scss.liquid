/*
 * Default Variables
 */
$body_padding:                        20px !default;
$body_navbar_padding:                 50px !default;
$inverse_threshhold:                  60%;

$default-primary-background-colour:    white !default;
$default-secondary-background-colour:  #f8f8f8 !default;
$default-text-colour:                  #333 !default;
$default-link-colour:                  #428bca !default;

/*
 * Setting Variables
 */
{% if settings.body-background-colour != blank %}
  $body-background-colour: {{ settings.body-background-colour }};
  $button-background-colour-default: $body-background-colour; // ???
{% else %}
  $body-background-colour: $default-primary-background-colour;
  $button-background-colour-default: white; // ???
{% endif %}
$body-heading-colour: {% if settings.body-heading-colour != blank %}{{ settings.body-heading-colour }}{% else %}$default-text-colour{% endif %};
$body-text-colour: {% if settings.body-text-colour != blank %}{{ settings.body-text-colour }}{% else %}$default-text-colour{% endif %};
{% if settings.body-link-colour != blank %}
  $body-link-colour: {{ settings.body-link-colour }};
  $button-colour-primary: inverse-colour($body-link-colour); // ???
{% else %}
  $body-link-colour: $default-link-colour;
  $button-colour-primary: white; // ???
{% endif %}

$navbar-background-colour: {% if settings.navbar-background-colour != blank %}{{ settings.navbar-background-colour }}{% else %}$default-secondary-background-colour{% endif %};
$navbar-text-colour: {% if settings.navbar-text-colour != blank %}{{ settings.navbar-text-colour }}{% else %}$body-text-colour{% endif %};
$navbar-link-colour: {% if settings.navbar-link-colour != blank %}{{ settings.navbar-link-colour }}{% else %}$body-link-colour{% endif %};

$sidebar-background-colour: {% if settings.sidebar-background-colour != blank %}{{ settings.sidebar-background-colour }}{% else %}transparent{% endif %};
$sidebar-heading-colour: {% if settings.sidebar-heading-colour != blank %}{{ settings.sidebar-heading-colour }}{% else %}$body-heading-colour{% endif %};
$sidebar-text-colour: {% if settings.sidebar-text-colour != blank %}{{ settings.sidebar-text-colour }}{% else %}$body-text-colour{% endif %};
$sidebar-link-colour: {% if settings.sidebar-link-colour != blank %}{{ settings.sidebar-link-colour }}{% else %}$body-link-colour{% endif %};

$footer-background-colour: {% if settings.footer-background-colour != blank %}{{ settings.footer-background-colour }}{% else %}transparent{% endif %};
$footer-heading-colour: {% if settings.footer-heading-colour != blank %}{{ settings.footer-heading-colour }}{% else %}$body-heading-colour{% endif %};
$footer-text-colour: {% if settings.footer-text-colour != blank %}{{ settings.footer-text-colour }}{% else %}$body-text-colour{% endif %};
$footer-link-colour: {% if settings.footer-link-colour != blank %}{{ settings.footer-link-colour }}{% else %}$body-link-colour{% endif %};

/*
 * Functions and Mixins
 */
@function inverse-colour( $colour, $strength: 100% ) {
  @return if(lightness($colour) > $inverse_threshhold, darken($colour, $strength), lighten($colour, $strength));
}

@function darken-colour( $colour, $background-colour, $strength: 100% ) {
  @if $colour == transparent {
    $colour: $body-background-colour;
  }
  @if $background-colour == transparent {
    $background-colour: $body-background-colour;
  }
  @return if(lightness($background-colour) > 10%, darken($colour, $strength), lighten($colour, $strength));
}

@function lighten-colour( $colour, $background-colour, $strength: 100% ) {
  @if $colour == transparent {
    $colour: $body-background-colour;
  }
  @if $background-colour == transparent {
    $background-colour: $body-background-colour;
  }
  @return if(lightness($background-colour) > $inverse_threshhold, lighten($colour, $strength), darken($colour, $strength));
}

@mixin button-variant($colour, $button-background-colour, $border-colour, $background-colour) {
  color: $colour;
  background-color: $button-background-colour;
  border-color: $border-colour;

  &:hover,
  &:focus,
  &:active,
  &.active {
    color: $colour;
    background-color: darken-colour($button-background-colour, $background-colour, 8%);
        border-color: darken-colour($border-colour, $background-colour, 12%);
  }
  .open & { &.dropdown-toggle {
    color: $colour;
    background-color: darken-colour($button-background-colour, $background-colour, 8%);
        border-color: darken-colour($border-colour, $background-colour, 12%);
  } }
  &:active,
  &.active {
    background-image: none;
  }
  .open & { &.dropdown-toggle {
    background-image: none;
  } }
  &.disabled,
  &[disabled],
  fieldset[disabled] & {
    &,
    &:hover,
    &:focus,
    &:active,
    &.active {
      background-color: $button-background-colour;
          border-color: $border-colour;
    }
  }
}

@mixin background-colour($colour){
  background-color: $colour;
  .page-header{
    border-bottom-color: darken-colour($colour, $colour, 7.5%);
  }  
  hr{
    border-top-color: darken-colour($colour, $colour, 7.5%);
  }
  .table-bordered, .table-bordered > thead > tr > th, .table-bordered > thead > tr > td, .table-bordered > tbody > tr > th, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > th, .table-bordered > tfoot > tr > td{
    border-color: darken-colour($colour, $colour, 7.5%);
  }
  
  .table-striped > tbody > tr:nth-child(odd) > td, .table-striped > tbody > tr:nth-child(odd) > th{
    background-color: darken-colour($colour, $colour, 4%);
  }
  
  .table-hover > tbody > tr:hover > td, .table-hover > tbody > tr:hover > th{
    background-color: darken-colour($colour, $colour, 6%);
  }
}

@mixin heading-colour($colour){
  h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6{
    color: $colour;
    & a{
      color: $colour;
      &:hover{
        color: darken($colour, 15%);
      }
    }
  }
}

@mixin text-colour($text-colour, $background-colour){
  color: $text-colour;
  .thumbnail .caption, .btn-default{
    color: $text-colour;
  }
  .text-muted, .nav > li.disabled > a, .breadcrumb > .active{
    color: lighten-colour($text-colour, $background-colour, 40%);
  }
  .thumbnail .caption, .btn-default{
    color: $text-colour;
  }
  .text-muted, .nav > li.disabled > a, .breadcrumb > .active{
    color: lighten-colour($text-colour, $background-colour, 40%);
  }
}

@mixin link-colour($text-colour, $background-colour){
  a{
    color: $text-colour;
    &:hover{
      color: darken($text-colour, 15%);
    }
  }
  .nav > li > a:hover, .nav > li > a:focus{
    background-color: darken-colour($background-colour, $background-colour, 7.5%);
  }
}

/*
 * Styles
 */
body{
  /* Navbar placement */
  {% if settings.navbar-placement == 'fixed-to-top' %}padding-top: $body_navbar_padding + $body_padding;{% elsif settings.navbar-placement == 'main-content' and settings.logo-placement != "above-navbar" %}padding-top: $body_padding;{% endif %}
  {% if settings.navbar-placement != 'fixed-to-bottom' and settings.fix-footer-navbar %}padding-bottom: $body_navbar_padding + $body_padding;{% endif %}
  {% if settings.navbar-placement == 'fixed-to-bottom' %}
    {% unless settings.logo-placement == "above-navbar" %}padding-top: $body_padding;{% endunless %}
    padding-bottom: $body_navbar_padding;
  {% endif %}
  {% if settings.navbar-placement == 'static-top' and settings.logo-placement == "above-navbar" %}.brand{ margin-bottom: 0; }{% endif %}
  /* Design and colour schemes */
  @include background-colour($body-background-colour);
  @include heading-colour($body-heading-colour);
  @include text-colour($body-text-colour, $body-background-colour);
  @include link-colour($body-link-colour, $body-background-colour);
}

.breadcrumb{
  background-color: darken-colour($body-background-colour, $body-background-colour, 7.5%);
}
.breadcrumb > li + li:before{
  color: lighten-colour($body-text-colour, $body-background-colour, 45%);
}

.navbar-default{
  @include background-colour($navbar-background-colour);
  @include text-colour($navbar-text-colour, $navbar-background-colour);
  @include link-colour($navbar-link-colour, $navbar-background-colour);
  .navbar-brand{
    color: $body-heading-colour;
    &:hover{
      color: darken($body-heading-colour, 15%);
    }
  }
}



.sidebar{
  @include background-colour($sidebar-background-colour);
  @include heading-colour($sidebar-heading-colour);
  @include text-colour($sidebar-text-colour, $sidebar-background-colour);
  @include link-colour($sidebar-link-colour, $sidebar-background-colour);
}

.footer{
  @include background-colour($footer-background-colour);
  @include heading-colour($footer-heading-colour);
  @include text-colour($footer-text-colour, $footer-background-colour);
  @include link-colour($footer-link-colour, $footer-background-colour);
  .container{
    @if $footer-background-colour == $body-background-colour or $footer-background-colour == transparent {
      border-top-color: darken-colour($footer-background-colour, $footer-background-colour, 7.5%);
    } @else {
      border-top: none;
    }
  }
}

/* Buttons (still need work) */
.pagination > li > a, .pagination > li > span{
  background-color: $button-background-colour-default;
  border-color: darken-colour($button-background-colour-default, $body-background-colour, 20%);
  &:hover{
    background-color: darken-colour($button-background-colour-default, $body-background-colour, 8%);
        border-color: darken-colour(darken($button-background-colour-default, 20%), $body-background-colour, 12%);
  }
}
.btn-default {
  @include button-variant($body-text-colour, $button-background-colour-default, darken($button-background-colour-default, 20%), $body-background-colour);
}
.btn-primary {
  @include button-variant($button-colour-primary, $body-link-colour, darken($body-link-colour, 5%), $body-background-colour);
}

@media (min-width: 768px){
  .sidebar{
    background-color: transparent;
    .sidebar-content{
      background-color: $sidebar-background-colour;
      @if $sidebar-background-colour == $body-background-colour or $sidebar-background-colour == transparent {
        padding: 0;
      }
    }
  }
}












/*
$inverse_threshhold: 50%;
$hover_strength: 5%;
$active_strength: 3%;

@function stronger( $color, $strength ) {
  @return if(lightness($color) > $inverse_threshhold, lighten($color, $strength), darken($color, $strength));
}

@function weaker( $color, $strength ) {
  @return if(lightness($color) > $inverse_threshhold, darken($color, $strength), lighten($color, $strength));
}

$primary_color: {{ settings.primary-color }};
$primary_color_inverse: if(lightness($primary_color) > $inverse_threshhold, darken($primary_color, 50%), lighten($primary_color, 50%));
$primary_shadow: rgba(if(lightness($primary_color) > $inverse_threshhold, lighten($primary_color, 100%), darken($primary_color, 100%)),0.3);

$secondary_color: {{ settings.secondary-color }};
$secondary_color_inverse: if(lightness($secondary_color) > $inverse_threshhold, darken($secondary_color, 50%), lighten($secondary_color, 50%));
$secondary_shadow: rgba(if(lightness($secondary_color) > $inverse_threshhold, lighten($secondary_color, 100%), darken($secondary_color, 100%)),0.3);

body {
  background-color: $secondary_color;
  color: $secondary_color_inverse;
  
  strong {
    font-weight: 400;
  }
  
  {% if settings.site-background-image %}background-image: url('{{ 'site-background-image-file.jpg' | asset_url }}');{% endif %}
  {% unless settings.site-background-image-repeat == blank %}background-repeat: {{ settings.site-background-image-repeat }};{% endunless %}
  {% unless settings.site-background-image-position == blank %}background-position: {{ settings.site-background-image-position }};{% endunless %}
  {% unless settings.body-font-custom == blank and settings.body-font == blank %}font-family: {% unless settings.body-font-custom == blank %}{{ settings.body-font-custom }}{% endunless %}{% unless settings.body-font == blank %}{% unless settings.body-font-custom == blank %}, {% endunless %}{{ settings.body-font }}{% endunless %};{% endunless %}
  {% unless settings.body-text-size == blank %}font-size: {{ settings.body-text-size }};{% endunless %}
  
  & a {
    color: $secondary_color_inverse;
      
    &:hover {
      color: stronger($secondary_color_inverse, $hover_strength);
    }
  }
}

p a {
  text-decoration: underline;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  color: $primary_color;
  
  {% unless settings.heading-font-custom == blank and settings.heading-font == blank %}font-family: {% unless settings.heading-font-custom == blank %}{{ settings.heading-font-custom }}{% endunless %}{% unless settings.heading-font == blank %}{% unless settings.heading-font-custom == blank %}, {% endunless %}{{ settings.heading-font }}{% endunless %};{% endunless %}
  {% unless settings.heading-case == blank %}text-transform: {{ settings.heading-case }};{% endunless %}
  {% unless settings.heading-font-weight == blank %}font-weight: {{ settings.heading-font-weight }};{% endunless %}
  {% unless settings.heading-style == blank %}font-style: {{ settings.heading-style }};{% endunless %}
  
  {% unless settings.heading-letterpress == blank %}
  text-shadow: 0 1px 0 $secondary_shadow;
  {% endunless %}
}

h1 {
  {% unless settings.heading-1-size == blank %}font-size: {{ settings.heading-1-size }};{% endunless %}
}

h2 {
  {% unless settings.heading-2-size == blank %}font-size: {{ settings.heading-2-size }};{% endunless %}
}

h3 {
  {% unless settings.heading-3-size == blank %}font-size: {{ settings.heading-3-size }};{% endunless %}
}

h4 {
  {% unless settings.heading-4-size == blank %}font-size: {{ settings.heading-4-size }};{% endunless %}
}

h5 {
  {% unless settings.heading-5-size == blank %}font-size: {{ settings.heading-5-size }};{% endunless %}
}

h6 {
  {% unless settings.heading-6-size == blank %}font-size: {{ settings.heading-6-size }};{% endunless %}
}

.breadcrumb > li {
  text-shadow: 0 1px 0 $secondary_shadow;
}

.navbar,
.dropdown-menu,
.dropdown-menu li,
.dropdown-menu li a {
  {% unless settings.navbar-font-weight == blank %}font-weight: {{ settings.navbar-font-weight }};{% endunless %}
}

footer .navbar,
.navbar-text {
  &,
  & small,
  & a {
    color: $primary_color_inverse;
  }
  
  & a:hover {
    color: weaker($primary_color, 100-$hover_strength);
  }
  
  & .muted {
    color: weaker($primary_color, 50%);
  }
}

.navbar {  
  {% unless settings.navbar-font-custom == blank and settings.navbar-font == blank %}font-family: {% unless settings.navbar-font-custom == blank %}{{ settings.navbar-font-custom }}{% endunless %}{% unless settings.navbar-font == blank %}{% unless settings.navbar-font-custom == blank %}, {% endunless %}{{ settings.navbar-font }}{% endunless %};{% endunless %}
  {% unless settings.navbar-size == blank %}font-size: {{ settings.navbar-size }};{% endunless %}
    
  & .brand {
    color: $primary_color_inverse;
    
    &:hover {
      color: stronger($primary_color_inverse, $hover_strength);
    }
  }
  
  & .btn-navbar .icon-bar {
    background-color: $primary_color_inverse;
  }
  
  & .btn-navbar,
  & .btn-navbar:hover,
  & .btn-navbar:focus,
  & .btn-navbar:active,
  & .btn-navbar.active,
  & .btn-navbar.disabled,
  & .btn-navbar[disabled] {
    background-color: weaker($primary_color, $hover_strength);
    background-image: none !important;
    color: $primary_color_inverse;
  }
  
  & .navbar-inner {
    background: $primary_color;
    background-image: none !important;
    border-color: stronger($primary_color, 10%);
    
    & .nav li a,
    & .brand {
      text-shadow: 0 1px 0 $primary_shadow;
    }
    
    & .nav li {
      & a {
        color: $primary_color_inverse;
      
        &:hover {
          background-color: stronger($primary_color, $hover_strength);
          color: stronger($primary_color_inverse, $hover_strength);
        }
        
        & .caret {
          border-top-color: $primary_color_inverse !important;
          border-bottom-color: $primary_color_inverse !important;
        }
      }
      
      &.active a {
        background-color: stronger($primary_color, $active_strength);
      }
      
      &.dropdown.open > .dropdown-toggle {
        background-color: stronger($primary_color, $hover_strength) !important;
        color: stronger($primary_color_inverse, $hover_strength);
      }
      
      & ul.dropdown-menu {
        background-color: stronger($primary_color, $hover_strength);
        
        & li a:hover,
        & li.active,
        & li.active a:hover {
          color: $primary_color_inverse;
          background-color: $primary_color;
        }
        
        & a {
          color: $primary_color_inverse;
        }
      }
    }
  }
}

.navbar .nav > li > .dropdown-menu::after {
  border-bottom-color: stronger($primary_color, 10%);
}

.nav {
  {% unless settings.nav-case == blank %}text-transform: {{ settings.nav-case }};{% endunless %}
  {% unless settings.nav-font-weight == blank %}font-weight: {{ settings.nav-font-weight }};{% endunless %}
  {% unless settings.nav-style == blank %}font-style: {{ settings.nav-style }};{% endunless %}
}

aside {
  {% unless settings.sidebar-font-custom == blank and settings.sidebar-font == blank %}font-family: {% unless settings.sidebar-font-custom == blank %}{{ settings.sidebar-font-custom }}{% endunless %}{% unless settings.sidebar-font == blank %}{% unless settings.sidebar-font-custom == blank %}, {% endunless %}{{ settings.sidebar-font }}{% endunless %};{% endunless %}
  {% unless settings.sidebar-size == blank %}font-size: {{ settings.sidebar-size }};{% endunless %}
}

aside .nav {
  {% unless settings.sidebar-nav-font-custom == blank and settings.sidebar-nav-font == blank %}font-family: {% unless settings.sidebar-nav-font-custom == blank %}{{ settings.sidebar-nav-font-custom }}{% endunless %}{% unless settings.sidebar-nav-font == blank %}{% unless settings.sidebar-nav-font-custom == blank %}, {% endunless %}{{ settings.sidebar-nav-font }}{% endunless %};{% endunless %}
  {% unless settings.sidebar-nav-case == blank %}text-transform: {{ settings.sidebar-nav-case }};{% endunless %}
}

.nav-collapse .navbar-form,
.nav-collapse .navbar-search {
  border-color: stronger($primary_color, 10%);
}

.navbar-fixed-bottom {
  {% unless settings.footer-font-custom == blank and settings.footer-font == blank %}font-family: {% unless settings.footer-font-custom == blank %}{{ settings.footer-font-custom }}{% endunless %}{% unless settings.footer-font == blank %}{% unless settings.footer-font-custom == blank %}, {% endunless %}{{ settings.footer-font }}{% endunless %};{% endunless %}
  {% unless settings.footer-size == blank %}font-size: {{ settings.footer-size }};{% endunless %}
  
}

.navbar .nav > .active > a,
.navbar .nav > .active > a:hover,
.navbar .nav > .active > a:focus {
  box-shadow: none !important;
}

.dropdown-menu>li>a:hover,
.dropdown-menu>li>a:focus,
.dropdown-submenu:hover>a,
.dropdown-submenu:focus>a,
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  background-image: none;
  background-color: stronger($primary_color, $active_strength) !important;
  color: stronger($primary_color_inverse, $active_strength) !important;
}

.table th,
.table td,
blockquote,
.page-header,
hr,
.footer {
  border-color: rgba($secondary_color_inverse,0.06);
}

.table-striped tbody > tr:nth-child(odd) > td,
.table-striped tbody > tr:nth-child(odd) > th,
aside .nav li.active a,
.footer {
  background-color: rgba($secondary_color_inverse,0.03);
}

.table-hover tbody tr:hover > td,
.table-hover tbody tr:hover > th,
ul.breadcrumb,
aside .nav .active a:hover,
aside .nav a:hover,
.footer .nav a:hover {
  background-color: rgba($secondary_color_inverse,0.04);
}

aside .nav li.active a {
  color: stronger($secondary_color_inverse, 10%);
  
  &:hover {
    color: weaker($secondary_color_inverse, 10%);
  }
}

.carousel-caption a {
  
}
*/

{% unless settings.custom-css == blank %}{{ settings.custom-css }}{% endunless %}